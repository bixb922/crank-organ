<!DOCTYPE html>
<!-- Copyright (c) 2023-2025 Hermann von Borries
 MIT License-->
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="stylesheet" type="text/css" href="/static/skeleton.css">
</head>
<body>
<!--<span id="popup" class="popuptext"></span>
<div class="headerdiv">
	<span class="headerleft">
        <a onclick="history.back()">&#11013;</a>
    </span>
	<span class="headerright" id="header_time"></span>
</div>
-->
<h1 id="header"></h1>
<span id="error_message"></span>
<script type="text/javascript" src="/static/common.js"></script>
<script type="text/javascript" src="/static/translations.js"></script>

<script src="https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0"></script>

<midi-player
  id="myMidiPlayer"
  sound-font visualizer="#myVisualizer">	
</midi-player>
<br>
<midi-visualizer id="myVisualizer" type="piano-roll">
</midi-visualizer>

<p>
  Internet access is necessary to visualize MIDI files.
</p>
<p>
  For more information, see <a href="https://github.com/cifkao/html-midi-player" target="_blank">the <strong>html-midi-player</strong> repository</a> on GitHub.
</p>

<script>
// (c) Copyright 2025 Hermann Paul von Borries. All rights reserved.
// MIT License

// PageHeader.setTitle(headerTitle, upAction)
let pageHeader = new PageHeader().setTitle( "MIDI", "back"  );


function decodeHTML(html) {
    var txt = document.createElement("p");
    txt.innerHTML = html;
    return txt.innerText ;
}


// Get last element of this page's URL, that's the MIDI file
let filename = new URL(window.location.href).pathname.split("/").at(-1) ;


get_url  = "/get_midi_file/" + filename
document.getElementById( "myMidiPlayer" ).src = get_url ;
document.getElementById( "myVisualizer" ).src = get_url ;
document.getElementById("header").innerText = decodeURIComponent(filename) ;

commonGetProgress.setSleep( 5_000 );
commonGetProgress.startBackground();

</script>
</body>
</html>